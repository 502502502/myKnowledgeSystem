![创建数据库表](../../../Desktop/大数据/截图-宁创涛/综合实验1-车辆GPS信息分析/创建数据库表.png)

**HDFS**

hdfs dfs -put /home/hadoop/data/temp/sogou-2.csv /user

hdfs dfs -ls /user



**standlone-client的spark:**

$SPARK_HOME/sbin/start-all.sh

start-dfs.sh



$SPARK_HOME/sbin/stop-all.sh

stop-dfs.sh



**hadoop集群**

start-all.sh

stop-all.sh



**spark历史服务**

$SPARK_HOME/sbin/start-history-server.sh

$SPARK_HOME/sbin/stop-history-server.sh





idea本地运行需要安装hadoop和winutils工具，配置环境变量



mysql驱动拷贝到spark的jars目录



**提交应用**

$SPARK_HOME/bin/spark-submit  --master spark://namenode:7077  --class edu.jlu.sql.sparksql_mysql  --jars learningspark.jar  10



from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

from sklearn.model_selection import train_test_split

import pandas as pd

import matplotlib.pyplot as plt



## 实验步骤

1、安装hadoop平台，配置网络

2、启动spark环境

3、安装idea开发环境，配置windows本地开发

+ maven依赖管理
+ scala插件安装
+ 本地调试
+ maven打包
+ 远程数据库调用

4、日志文件上传hdfs

5、spark提交打好的jar包

+ 拷贝mysql驱动
+ 增加统计域名点击量的代码
  + 使用正则表达式提取域名
+ 提交运行程序

6、编写idea可视化项目

+ maven配置
+ 将静态资源拷贝到resource目录
+ 调整js代码访问路径
+ 配置springboot首页路径
+ 修改业务代码和展示代码
+ 增加域名统计量的查询和报表展示

7、运行

